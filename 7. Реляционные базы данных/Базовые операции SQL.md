### Основные операции SQL и примеры их использования:

**Порядок SQL-запросов**
```sql
SELECT DISTINCT column1, column2
FROM table1
JOIN table2 ON table1.id = table2.id
WHERE condition
GROUP BY column1
HAVING condition
ORDER BY column1
LIMIT 10;
```

1. **SELECT** - используется для выборки данных из базы данных.
```sql
SELECT имя, фамилия FROM пользователи;
```

2. **INSERT INTO** - используется для вставки новых данных в таблицу.
```sql
INSERT INTO пользователи (имя, фамилия, возраст) VALUES ('Иван', 'Иванов', 30);
```

3. **UPDATE** - используется для обновления существующих данных в таблице.
```sql
UPDATE пользователи SET возраст = 31 WHERE имя = 'Иван' AND фамилия = 'Иванов';
```

4. **DELETE** - используется для удаления данных из таблицы.
```sql
DELETE FROM пользователи WHERE имя = 'Иван' AND фамилия = 'Иванов';
```

5. **CREATE TABLE** - используется для создания новой таблицы.
```sql
CREATE TABLE пользователи (
    id INT PRIMARY KEY,
    имя VARCHAR(100),
    фамилия VARCHAR(100),
    возраст INT
);
```

6. **ALTER TABLE** - используется для изменения структуры существующей таблицы.
```sql
ALTER TABLE пользователи ADD email VARCHAR(255);
```

7. **DROP TABLE** - используется для удаления таблицы.
```sql
DROP TABLE пользователи;
```

8. **JOIN** - используется для объединения строк из двух или более таблиц, основываясь на связанных столбцах.
```sql
SELECT пользователи.имя, заказы.номер_заказа
FROM пользователи
INNER JOIN заказы ON пользователи.id = заказы.пользователь_id;
```

9. **GROUP BY** - используется для группировки строк, которые имеют одинаковые значения в указанных столбцах.
```sql
SELECT COUNT(*), страна FROM пользователи GROUP BY страна;
```

10. **HAVING** - используется вместе с `GROUP BY` для фильтрации групп по определенному условию.
```sql
SELECT страна, COUNT(*) FROM пользователи GROUP BY страна HAVING COUNT(*) > 10;
```

11. **ORDER BY** - используется для сортировки результатов запроса в порядке возрастания или убывания.
```sql
SELECT имя, возраст FROM пользователи ORDER BY возраст DESC;
```

12. **LIMIT** - используется для ограничения количества строк, возвращаемых запросом.
```sql
SELECT * FROM пользователи LIMIT 5;
```

13. **INDEX** - используется для создания индекса для ускорения поиска данных.
```sql
CREATE INDEX idx_имя ON пользователи (имя);
```

14. **UNION** - используется для объединения результатов двух или более запросов `SELECT` в один набор результатов.
```sql
SELECT имя FROM работники
UNION
SELECT имя FROM клиенты;
```

15. **CASE** - используется для создания условных операторов в SQL запросах.
```sql
SELECT имя,
CASE 
    WHEN возраст < 20 THEN 'молодой'
    WHEN возраст BETWEEN 20 AND 60 THEN 'взрослый'
    ELSE 'пожилой'
END AS возрастная_категория
FROM пользователи;
```

16. **TRANSACTION** - используется для управления транзакциями, позволяя группировать несколько шагов в одну операцию.
```sql
START TRANSACTION;
INSERT INTO заказы (id_пользователя, сумма) VALUES (1, 100);
UPDATE пользователи SET баланс = баланс - 100 WHERE id = 1;
COMMIT;
```

17. **ROLLBACK** - используется для отмены транзакции, если во время её выполнения произошла ошибка.
```sql
START TRANSACTION;
INSERT INTO заказы (id_пользователя, сумма) VALUES (1, 100);
UPDATE пользователи SET баланс = баланс - 100 WHERE id = 1;
ROLLBACK;
```

18. **SAVEPOINT** - позволяет установить точку в транзакции, к которой можно вернуться.
```sql
START TRANSACTION;
SAVEPOINT sp1;
INSERT INTO заказы (id_пользователя, сумма) VALUES (1, 100);
ROLLBACK TO sp1;
COMMIT;
```

19. **TRIGGER** - позволяет автоматически выполнять заданный набор операций перед или после изменений в таблице.
```sql
CREATE TRIGGER после_добавления_пользователя
AFTER INSERT ON пользователи
FOR EACH ROW
BEGIN
   INSERT INTO логи (событие) VALUES ('Добавлен новый пользователь');
END;
```

20. **VIEW** - позволяет создать виртуальную таблицу, основанную на результате запроса.
```sql
CREATE VIEW активные_пользователи AS
SELECT имя FROM пользователи WHERE статус = 'активный';
```

21. **WITH** (Common Table Expressions, CTE) - позволяет определить временную таблицу, которую можно использовать в последующем запросе.
```sql
WITH временнаяТаблица AS (
    SELECT * FROM пользователи WHERE возраст > 30
)
SELECT * FROM временнаяТаблица;
```

22. **WINDOW FUNCTION** - функции, применяемые к набору строк, которые каким-то образом связаны с текущей строкой.
```sql
SELECT имя, возраст, AVG(возраст) OVER (PARTITION BY пол) FROM пользователи;
```

23. **RECURSIVE CTE** - расширение CTE, позволяющее выполнять рекурсивные запросы.
```sql
WITH RECURSIVE cte (число) AS (
    SELECT 1
    UNION ALL
    SELECT число + 1 FROM cte WHERE число < 10
)
SELECT * FROM cte;
```

24. **PIVOT** - позволяет переворачивать строки в столбцы, облегчая агрегацию и сравнение данных.
```sql
SELECT * FROM 
(
    SELECT имя, предмет, оценка FROM оценки
) AS исходнаяТаблица
PIVOT
(
    AVG(оценка)
    FOR предмет IN ([Математика], [Физика], [Литература])
) AS pivotTable;
```

25. **MERGE** (UPSERT) - позволяет одновременно обновлять и вставлять записи, проверяя их наличие в таблице.
```sql
MERGE INTO цели AS target
USING (SELECT id, имя FROM временнаяТаблица) AS source
ON (target.id = source.id)
WHEN MATCHED THEN
    UPDATE SET target.имя = source.имя
WHEN NOT MATCHED THEN
    INSERT (id, имя) VALUES (source.id, source.имя);
```
